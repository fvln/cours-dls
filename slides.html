<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />

    <title>Administration Linux avanc√©e</title>
    <link rel="shortcut icon" href="./favicon.ico" />
    <link rel="stylesheet" href="./dist/reset.css" />
    <link rel="stylesheet" href="./dist/reveal.css" />
    <link rel="stylesheet" href="./dist/theme/solarized.css" id="theme" />
    <link rel="stylesheet" href="./css/highlight/base16/zenburn.css" />

    <link rel="stylesheet" href="./_assets/custom.css" />
  </head>
  <body>
    <div class="reveal">
      <div class="slides">
        <section data-markdown data-separator="xxx" data-separator-vertical="---">
          <textarea data-template>
            


# Administration Linux avanc√©e

P√¥le sup de La Salle

Florent Vuillemin

xxx

### Sommaire

* [D√©couverte du syst√®me](#/decouverte-systeme)
* [D√©couverte de la ligne de commande](#/decouverte-ligne-cmd)
* [Gestion des droits](#/droits-unix)
* [Anecdotes](#/anecdotes)

xxx

## Introduction

---

### Qui suis-je ?

Florent Vuillemin ‚Äì florent@fvln.fr

D√©veloppeur depuis 2005

- D√©veloppeur bas niveau -> front (Linux, embarqu√©)
  - 8 ans chez Orange Business Services
  - 5 ans √† la DGA, √©quipe cyberd√©fense
  - Orange Labs depuis 2018 (phishing)

- 2 modules au p√¥le sup de La Salle :
  - BSI : Administration Linux
  - MSI1 : ~~S√©curit√© IOT~~ Programmation syst√®me

---

#### La formation

<div id="left">

D√âVELOPPEMENT
- Algorithme avanc√©e : listes, tris et arbres ;
- Langage C avanc√© ;
- **Langage de scripting Shell et Python ;**
- Architectures et conception de bases de donn√©es relationnelles.

MANAGEMENT DE PROJETS FONDAMENTAUX
- Planification de projets SI : lots, MS Project.

COMMUNICATION ‚Äì ANGLAIS PROFESSIONNEL

S√âCURIT√â INFORMATIQUE
-  Linux administration avanc√© ;

</div>

<div id="right">

- Administration et supervision r√©seau ;
- Technologies r√©seaux et certification CISCO CCNA1 ;
- Technologies r√©seaux et certification CISCO CCNA2 ;
- Assembleur et application √† la s√©curit√© ;
- Cryptologie, cl√©s et certificats ;
- S√©curit√© d√©tection et analyse de vuln√©rabilit√©s ;
- S√©curit√© et intrusion physique ;
- S√©curit√© des r√©seaux wifi ;
- **S√©curit√© et hardening des OS ;**
- Digital Forensics ;
- S√©curit√© certification CEH.

</div>

---

#### Objectifs du module

- √ätre √† l‚Äôaise au quotidien sous Linux
- Savoir d√©ployer et configurer des services
- Automatiser les t√¢ches
  ‚Üí cf. _Cours ¬´¬†Scripting shell¬†¬ª_
- Savoir o√π chercher en cas de probl√®me
- S√©curiser son environnement
  ‚Üí cf. _Cours ¬´¬†S√©curit√© et hardening des OS¬†¬ª_

- Parler de s√©curit√© !

---

#### Programme

üìå https://gist.github.com/fvln/

- Ratio : 10% de cours / 90% de TP

- Peut-√™tre une session de culture g√©n√©rale s√©curit√©

- **Notes**
    - S1 : QCM
    - S2 : TP not√©

- **Livrable**
    - Mini projet scripting

---

#### Challenges

- CTF des MSI et l'asso Shields : https://ctf.polesup-delasalle.fr/

- root-me : https://www.root-me.org/ 

![](img/shields.png) <!-- .element width="600" -->

---

#### Quel est votre niveau ? J'ai d√©j√†‚Ä¶

<div id="left">

‚òê Utilis√© GNU/Linux

‚òê Utilis√© un terminal

‚òê Cod√© un script shell sous Linux

‚òê Compil√© un programme sous Linux

‚òê Utilis√© un Raspberry Pi

‚òê Utilis√© vim avec succ√®s

‚òê Mont√© un partage NFS

‚òê Utilis√© Docker

</div>

<div id="right">

‚òê Compil√© un rapport LaTeX

‚òê Configur√© le r√©seau sous Linux

‚òê Compris la diff√©rence entre Linux et GNU/Linux

‚òê D√©ploy√© un serveur web sous Linux

‚òê Cherch√© des infos sur StackOverflow

‚òê Ecrit un fichier Makefile

‚òê Compil√© un noyau Linux

</div>

---

#### De quelle formation arrivez-vous ?

<div id="left">

‚òê R√©seau ?

‚òê Windows ?

‚òê Linux ?

‚òê Dev ?

‚òê Scripting ?

‚òê S√©curit√© ?


</div>

<div id="right">

‚òê Quelle est votre entreprise ?

‚òê Quel est l'objet de votre alternance ?

</div>


xxx

<!-- .slide: id="decouverte-systeme" -->


## D√©couverte du syst√®me
 
P√¥le sup de La Salle

Florent Vuillemin

xxx

### How it started

```txt
Linus Benedict Torvalds
25 ao√ªt 1991, 22:57:08


Hello everybody out there using minix -

I'm doing a (free) operating system (just a hobby, won't be big and
professional like gnu) for 386(486) AT clones. This has been brewing
since april, and is starting to get ready. I'd like any feedback on
things people like/dislike in minix, as my OS resembles it somewhat
(same physical layout of the file-system (due to practical reasons)
among other things).

I've currently ported bash(1.08) and gcc(1.40), and things seem to work.
This implies that I'll get something practical within a few months, and
I'd like to know what features most people would want. Any suggestions
are welcome, but I won't promise I'll implement them :-)

Linus (torvalds@kruuna.helsinki.fi)

PS. Yes - it's free of any minix code, and it has a multi-threaded fs.
It is NOT protable (uses 386 task switching etc), and it probably never
will support anything other than AT-harddisks, as that's all I have :-(. 
```

---

#### Le noyau Linux

- Un noyau  de syst√®me d‚Äôexploitation d√©velopp√© par Linus Torvalds depuis 1991
- Appartient √† la famille des Unix (norme POSIX)
- Multi-utilisateurs, multi-t√¢ches
- Modulaire

![Tux](img/tux.png)

---

#### Le syst√®me GNU/Linux

- Fond√© en 1984 par Richard Stallman
- Un ensemble de logiciels (libres) compatibles Unix
  - Compilateur : `gcc`
  - Biblioth√®que de fonctions : `glibc`
  - Editeur de texte : `GNU Emacs`
  - Commandes de base : `GNU Coreutils`
- Une licence : GNU General Public License (GPL)

---

#### Richard Stallman

![Richard Stallman](img/Richard_Stallman_at_LibrePlanet_2019.jpg)

---

#### Un peu d'architecture

![](img/linux%20architecture.png)

xxx

### Le syst√®me GNU/Linux

Un noyau

Des programmes

et...

---

#### Les environnements de bureau

<div id="left">

L‚Äôinterface graphique permettant de manipuler le syst√®me
- Gnome
- Kde
- Xfce
- Lxde
- Enlightment...

Et CDE ‚û°

</div>

<div id="right"> <!-- .element: class="fragment" -->

![CDE](img/CDE_2012_on_Linux.png) 

</div>

---

#### Distributions

- Un noyau, des modules
- Des programmes dans des versions pr√©cises
- Personnalis√©s et int√©gr√©s 

![Distributions Linux](img/distribution_linux_logo.jpg)

---

#### Distributions (avec troll)

![Distributions Linux](img/troll_distributions.jpg)

xxx

### Les processus

<div id="left">

- Un identifiant unique (PID)
- A les droits d‚Äôun utilisateur et d‚Äôun groupe
- Une relation de descendance
- Fork = Duplication
- Exec = Remplacement du processus

</div>

<div id="right"> <!-- .element: class="fragment" -->

![Fork](img/pid_fork.gif)

</div>

---

### Les processus

![Sacrifice child](img/sacrifice_child.jpg) <!-- .element: style="height: 800px" -->

---

### Le syst√®me de fichiers

- Un arbre unique dont la racine est `/`
- Les √©l√©ments du chemin sont √©galement s√©par√©s par le caract√®re `/`
- Exemple de chemin : `/home/jono/work`

![Filesystem](img/filesystem.png)

---

### Le syst√®me de fichiers

- Les **points de montage** sont des r√©pertoires contenant l‚Äôarborescence de fichiers d‚Äôun p√©riph√©rique (physique ou virtuel)

![Points de montage](img/mountpoints.png)

---

### TP 1

- Les environnements de bureau
- Les processus
- Le syst√®me de fichiers


xxx

<!-- .slide: id="decouverte-ligne-cmd" -->
## D√©couverte de la ligne de commande
 
### `$`

xxx

### D'o√π vient le terminal ?

![VT100](img/DEC_VT100_terminal.jpg)

---

#### Comment √ßa marche ?

![Terminal et shell](img/terminal-shell.PNG)

---

#### Le terminal

- G√®re le fen√™trage (taille, ic√¥nes... )

- G√®re l'affichage (police, taille, couleurs... )

- Ex√©cute un programme lorsqu'on l'ouvre

---

#### Le shell

<div id="left">

- Ils sont nombreux : sh, ash, bash, ksh, csh‚Ä¶
- Nous utiliserons bash : Bourne-again Shell (GNU)
- Certaines commandes sont int√©gr√©es, d‚Äôautres sont des programmes de la machine

</div>

<div id="right">

Fonctions :
- Auto-compl√©tion (Tab)
- Jokers (`*`)
- Pipeline (`|`)
- Substitution de commandes (\`\`)
- Variables (`$`)
- Boucles et structures de contr√¥le (for, if‚Ä¶)

</div>

---

#### Trouver de l'aide

<div id="left">

```sh
<commande> --help
man [<section>] <commande>
whatis <commande>
apropos <mot-cl√©>
```

Et le classique :

![](img/RTFM.png)

</div>

<div id="right">

| Section | Description |
|-|-|
| 1 | Commandes g√©n√©rales |
| 2 | Appels syst√®me |
| 3 | Fonctions de la biblioth√®que standard (libc) |
| 4 | Fichiers sp√©ciaux et p√©riph√©riques |
| 5 | Formats de fichiers et conventions |
| 6 | Jeux et √©crans de veille |
| 7 | Misc |
| 8 | Commandes d'administation et d√©mons |

</div>

---

#### M√©fiez-vous de ChatGPT

![ChatGPT](img/chatgpt.png)

---

### TP 2, premi√®re partie

- D√©couvrir la console et le shell
- Manipuler des fichiers
- Le r√¥le du `$PATH`

xxx

### Entr√©es, sorties et signaux

---

#### Les flux

![Flux](img/flux.PNG)

---

#### Les signaux

![Signaux](img/Conceptual_picture_of_signals.png)

---

#### Les signaux

- Chaque processus peut choisir de traiter / retarder / masquer certains signaux
- Sinon, une action par d√©faut est effectu√©e
- Liste : http://mat.free.free.fr/downloads/unix/signaux.pdf
- Ou : `man 7 signal`

![Signaux](img/ct1-large1.png)

---

#### TP 2, suite

- Entr√©e et sorties standard, redirection de flux
- Codes de retour
- Envoi et r√©ception de signaux
- Paternit√© des processus


xxx

<!-- .slide: id="droits-unix" -->
## Droits d'acc√®s
 
![](img/grands-pouvoirs.jpg)

---

### Gestion des utilisateurs

![](img/utilisateurs%20et%20groupes.PNG)

---

### Les types de fichiers

<div id="left">

![Types de fichiers](img/ls-l.PNG) <!-- .element height="400" -->

</div>

<div id="right">

| Section | Description |
|-|-|
| - | Fichier standard |
| d | **Directory**, r√©pertoire |
| l | **Link**, lien symbolique |
| p | **Pipe**, tube nomm√© cr√©√© avec `mkfifo` |
| c | **Character**, p√©riph. de type caract√®re |
| b | **Block**, p√©riph. de type bloc |

</div>

---

### Les droits d'acc√®s

`crw-rw-rw- 1 root root      1,   3 ao√ªt  21 15:15 null`

![](img/Linux-Permission.png) <!-- .element height="350" -->

---

### Les bits de mode √©tendu

* SetUID / SetGID : L‚Äôutilisateur qui ex√©cute ce programme obtient les droits du propri√©taire/du groupe du fichier

```sh
$ ls -l my_script 
-rwsr-sr-x 1 owner group 158998 mar 12 17:12 my_script
```

* C‚Äôest la diff√©rence entre l‚Äôutilisateur/groupe r√©el et effectif

---

### Le sticky bit

* Sticky bit : sur un r√©pertoire, il interdit aux utilisateurs de supprimer les fichiers des autres, m√™me s‚Äôils ont les droits en √©criture

```sh
$ ls -l / | grep tmp
drwxrwxrwt  7 root root      180 Sep  6 23:05 tmp
```

---

### D√©finir les droits d'acc√®s

- Octal :
  - `chmod 600 key_rsa`
  - `chmod 755 install_script.sh`

- Repr√©sentation symbolique :
  - `chmod a+x install_script.sh`
  - `chmod g+rw,o-rw my_group_report`

---

### L'utilisateur root

* Un compte sp√©cial UID=0, GID=0
* Ne subit pas les contraintes d‚Äôacc√®s des autres utilisateurs

* Mais n'a pas forc√©ment toutes les permissions non plus (capabilities)

---

### Les `sudoers`

* Bas√© sur la commande sudo (pas toujours install√©e)
* Permet d'accorder le droit root sur un p√©rim√®tre r√©duit :
  * Certains utilisateurs
  * Certains groupes (par exemple wheel)
  * Pour lancer certaines commandes


---

### TP 3

- Droits sur les fichiers
- Le compte root
- Gestion des utilisateurs
- Modes √©tendus

_Ne passez pas root si ce n'est pas demand√© !_




xxx

<!-- .slide: id="anecdotes" -->
## Scott E. Fahlman
 
```txt
19-Sep-82 11:44    Scott E  Fahlman             :-)
From: Scott E Fahlman <Fahlman at Cmu-20c>
 
I propose that the following character sequence for joke markers:

:-)
        
Read it sideways.  Actually, it is probably more economical to mark
things that are NOT jokes, given current trends.  For this, use
        
:-(
```

---

### Sa page perso

http://www.cs.cmu.edu/~sef/

![](img/scott-fahlman.PNG)

---

          </textarea>
        </section>
      </div>
    </div>

    <script src="./dist/reveal.js"></script>

    <script src="./mermaid/dist/mermaid.min.js"></script>

    <script src="./plugin/markdown/markdown.js"></script>
    <script src="./plugin/highlight/highlight.js"></script>
    <script src="./plugin/zoom/zoom.js"></script>
    <script src="./plugin/notes/notes.js"></script>
    <script src="./plugin/math/math.js"></script>
    <script>
      function extend() {
        var target = {};
        for (var i = 0; i < arguments.length; i++) {
          var source = arguments[i];
          for (var key in source) {
            if (source.hasOwnProperty(key)) {
              target[key] = source[key];
            }
          }
        }
        return target;
      }

      // default options to init reveal.js
      var defaultOptions = {
        controls: true,
        progress: true,
        history: true,
        center: true,
        transition: 'default', // none/fade/slide/convex/concave/zoom
        slideNumber: true,
        highlight: {
          highlightOnLoad: false
        },
        plugins: [
          RevealMarkdown,
          RevealHighlight,
          RevealZoom,
          RevealNotes,
          RevealMath
        ]
      };

      // options from URL query string
      var queryOptions = Reveal().getQueryHash() || {};

      var options = extend(defaultOptions, {"controls":false,"slideNumber":false,"transition":"slide","backgroundTransition":"fade","width":1800,"height":1000,"center":true,"_":["slides.md"],"preprocessor":"../../../includes.js","css":"custom.css","static":"build"}, queryOptions);
    </script>


    <script>
      Reveal.initialize(options);
      Reveal.addEventListener('ready', function (event) {
        const blocks = Reveal.getRevealElement().querySelectorAll('pre code:not(.mermaid)');
        const hlp = Reveal.getPlugin('highlight');
        blocks.forEach(hlp.highlightBlock);
      });
    </script>

    <script>
      const mermaidOptions = extend({ startOnLoad: false }, {});
      mermaid.startOnLoad = false;
      mermaid.initialize(mermaidOptions);
      const cb = function (event) { mermaid.init(mermaidOptions, '.stack.present>.present pre code.mermaid'); };
      Reveal.addEventListener('ready', cb);
      Reveal.addEventListener('slidetransitionend', cb);
    </script>
  </body>
</html>
